## 一、资产管理

点击页面左侧菜单，展开“资产”项目，然后点击“主机及账号”，会打开主机管理页面，远程主机和远程登录账号的管理主要在这个界面中进行。

![web-host-acc](img/web-host-acc.png)

### 1.1 	添加主机

点击页面右上方的“添加主机”按钮，然后在弹出的对话框中根据你要添加的远程主机的信息选择和填写相关内容：

 - **远程主机系统**： 可选择Windows或者Linux/Unix；
 - **远程主机地址**： 填写远程主机的IP地址，目前teleport尚未支持域名方式连接远程主机；
 - **连接模式**： 可选择直接连接或者端口映射模式；
 - 名称/资产编号/备注： （选填）为方便区分可填写相关信息。

![web-add-host-1](img/web-add-host-1.png)

其中“连接模式”一项，如果此远程主机可以由teleport服务器直接连接，则可以选择“直接连接”模式，例如远程主机与teleport服务器处于同一个局域网中，或者远程主机是开放了远程连接端口的云端服务器等。

如果远程主机与teleport服务器之间需要通过其他网络设备进行端口映射方可连接的，则需要选择“端口映射”模式。在这种模式下，teleport服务器实际上连接的是配置的 **路由主机** 的地址和映射端口，而非远程主机地址。

![web-add-host-2](img/web-add-host-2.png)

端口映射模式常用于以下场景：

 - teleport服务器处于公司内网，被维护的远程主机在云端且没有公网IP，需要通过一台有公网IP的服务器进行跳转。集群服务器常使用这种方式。
 - 使用teleport服务器管理运行docker的主机以及进入docker内部进行管理。

主机信息填写完毕后，点击“确定”按钮即可完成主机的添加。

### 1.2 添加账号

添加完主机后，还需要为此主机设置远程登录的账号，点击主机的账号数量，或者右侧操作菜单中的“管理远程账号”，会显示远程账号管理对话框。

![web-asset-manage-acc](img/web-asset-manage-acc.png)

然后点击“添加账号”按钮，弹出添加远程账号的对话框。需要注意的是，如果主机的连接模式使用端口映射模式，那么这里的“端口”项是无法更改的。

![web-asset-add-acc](img/web-asset-add-acc.png)

远程账号信息填写完毕后，可以使用对话框上的“测试连接”按钮来进行测试。

#### 1.2.1 RDP协议

添加账号时，如果远程账号是Windows域用户，那么账号名称需要使用 `user@domain` 这样的形式，而不能使用 `domain\user` 的形式。后者虽然可以正常远程登录使用，但会导致无法进行录像回放。因为teleport在回放RDP录像时，会下载录像文件到本地，文件名中会包含远程账号名称，而远程账号中的字符 `\` 是操作系统的路径风格符，从而导致无法创建本地文件使得下载失败。

#### 1.2.2 SSH协议

如果是SSH协议，那么认证方式可以选择“SSH私钥认证”，此时密码输入框将被替换为SSH私钥输入框。目前teleport **仅支持RSA私钥，且私钥不能是密码加密后的**。私钥的格式如下所示：

```text
-----BEGIN RSA PRIVATE KEY-----
MIIEoAIBAAKCAQBki7kohX+oa0AELV8Oflrz545PQS47H5mh/sQ6KRHkt7bErVC3
watQdeXFHrnH0uKbmglFS6MVni86/tltqxxt+dcgTBsNyFiuUtSQBlIIwBiqtpFl
......
JQKBgBWsgyj+So3nB8nVsRFawarouM+xfwN+12CeLrlHVxvOdJ5LBF+uhPUO75qG
jU8XyGm54zSLsZfjyJ5IQu4WmiuEhzQagceML9x2INHHXE3w
-----END RSA PRIVATE KEY-----
```

如果你使用的私钥不是以上格式，请用相关工具进行转换方可在teleport中使用。

**注意，私钥对应的公钥应该预先部署在你的远程主机上了，具体操作可搜索“SSH免密码登录”。**

#### 1.2.3 TELNET协议

在添加telnet协议的远程账号时，如果使用用户名/密码认证方式，会要求填写“用户名预期提示”和“密码预期提示”两项内容。这是因为telnet本身是**弱协议**，也就是说它并没有明确定义用户如何登陆，何时输入用户名或者密码，不同的telnet服务有着各自不同的实现方式。比如说，有些telnet服务会显示 `Login:` 来提示用户输入用户名，而另一些则用 `username:` 进行提示，还有的用 `login:` 进行提示。而teleport在检测到对应的提示时，才能够正确填写相应的用户名和密码来完成自动登录。

所以，在添加telnet协议的远程账号之前，你需要手动连接一次你的telnet服务器，查看它的提示语，然后将其填写到预期提示的输入框中。

![web-asset-add-acc-telnet](img/web-asset-add-acc-telnet.png)

小技巧：默认的预期提示 `ogin:` 和 `assword:`，其实是 `login:` 和 `password:` 去掉了第一个字母，是因为常见的telnet服务多数使用这两个提示语，但是一些首字母是大写，一些首字母是小写。跳过第一个字母则可以增加适配性。

### 1.3 批量添加主机和账号


### 1.4 主机管理

### 1.5 账号管理

## 二、主机分组管理

## 三、账号分组管理













